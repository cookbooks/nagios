# Command definitions
# Automatically generated by Chef

# Host checks

define command {
  command_name    check-host-alive
  command_line    $USER1$/check_ping -H $HOSTADDRESS$ -w 2000,80% -c 3000,100% -p 1
}

# Fortigate Checks

define command {
  command_name  check_fortigate_cpu
  command_line  /u/nagios/plugins/check_cpu.pl -T fg -H $HOSTADDRESS$ -C $ARG1$ -w $ARG2$ -c $ARG3$ 
}

define command {
  command_name  check_fortigate_memory
  command_line  /u/nagios/plugins/check_fortigate_memory.pl -H $HOSTADDRESS$ -C $ARG1$ -w $ARG2$ -c $ARG3$
}

define command{
  command_name   check_fortigate_port
  command_line   $USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o IF-MIB::ifOperStatus.$ARG2$ -R up
}

# Cisco Checks

define command{
  command_name   check_cisco_stack
  command_line   /u/nagios/plugins/check_cisco_stack.pl -H $HOSTADDRESS$ -C $ARG1$
}

define command{
  command_name   check_cisco
  command_line   /u/nagios/plugins/check_cisco.pl -h $HOSTADDRESS$ -c $ARG1$ -i $ARG2$ -s up
}

define command {
  command_name  check_cisco_cpu
  command_line  $USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o $ARG2$ -w $ARG3$ -c $ARG4$ 
}

# APC Checks

define command{
  command_name   check_apc_load_total
  command_line   $USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o 1.3.6.1.4.1.318.1.1.12.2.3.1.1.2.1 -w $ARG2$ -c $ARG3$ 
}

define command{
  command_name   check_apc_load_bank_1
  command_line   $USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o 1.3.6.1.4.1.318.1.1.12.2.3.1.1.2.2 -w $ARG2$ -c $ARG3$ 
}

define command{
  command_name   check_apc_load_bank_2
  command_line   $USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o 1.3.6.1.4.1.318.1.1.12.2.3.1.1.2.3 -w $ARG2$ -c $ARG3$ 
}

# Isilon Checks

define command{
        command_name    check_snmp_cluster_health
        command_line    $USER1$/check_snmp -H $HOSTADDRESS$ -o .1.3.6.1.4.1.12124.1.1.2.0 -C $ARG1$
}

# Service checks

define command {
  command_name    check_haproxy_queue
  command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_$ARG1$_haproxy_queue -t 20
}

define command {
  command_name    check_file_age
  command_line    $USER1$/check_by_ssh -H $HOSTADDRESS$ -C "/usr/local/bin/check_file -i -p $ARG1$ -w $ARG2$ -c $ARG3$" -l root
}

define command {
  command_name    check_local_file_age
  command_line    $USER1$/check_file_age $ARG1$ -w $ARG2$ -c $ARG3$
}

define command {
  command_name    check_file_count
  command_line    $USER1$/check_by_ssh -H $HOSTADDRESS$ -C "<%= @node[:nagios][:plugins_dir] %>/file_queues.rb -t count -p $ARG1$ -w $ARG2$ -c $ARG3$" -l app
}

define command {
  command_name    check_log
  command_line    $USER1$/check_by_ssh -H $HOSTADDRESS$ -C "/usr/lib/nagios/plugins/check_log -F $ARG1$ -O /tmp/nagios.logcheck.processed -q $ARG2$" -l app
}

define command { 
  command_name    check_highrise_item_age
  command_line    <%= @node[:nagios][:plugins_dir] %>/check_highrise.rb -s $ARG1$ -a $ARG2$ -i $ARG3$ -c $ARG4$ -w $ARG5$
}

define command { 
  command_name    check_mogilefs_bored_workers
  command_line    <%= @node[:nagios][:plugins_dir] %>/check_mogilefs_bored_workers.rb -h $HOSTADDRESS$ -p $ARG1$ -c $ARG2$ -w $ARG3$
}

define command { 
  command_name    check_redis
  command_line    <%= @node[:nagios][:plugins_dir] %>/check_redis.rb $HOSTADDRESS$ $ARG1$
}

define command { 
  command_name    check_solr
  command_line    <%= @node[:nagios][:plugins_dir] %>/check_solr.rb -c 10 -h $HOSTADDRESS$ -r 10 -p $ARG1$
}

define command { 
  command_name    query_solr
  command_line    <%= @node[:nagios][:plugins_dir] %>/check_solr.rb -c 10 -h $HOSTADDRESS$ -r 10 -p $ARG1$ -q $ARG2$
}

define command { 
  command_name    check_mem
  command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_mem -t 20
} 

define command {
	command_name	check_query_count
	command_line	<%= @node[:nagios][:plugins_dir] %>/db_queues.rb -H $HOSTADDRESS$ -P $ARG1$ -u $ARG2$ -p $ARG3$ -d $ARG4$ -q $ARG5$ -w $ARG6$ -c $ARG7$
}

define command{
  command_name   check_snmp
  command_line   $USER1$/check_snmp -H $HOSTADDRESS$ $ARG1$
}

define command{
        command_name    check_local_disk
        command_line    $USER1$/check_disk -w $ARG1$ -c $ARG2$ -p $ARG3$
        }


define command{
        command_name    check_local_load
        command_line    $USER1$/check_load -w $ARG1$ -c $ARG2$
        }


define command{
        command_name    check_local_procs
        command_line    $USER1$/check_procs -w $ARG1$ -c $ARG2$ -s $ARG3$
        }

define command{
        command_name    check_local_users
        command_line    $USER1$/check_users -w $ARG1$ -c $ARG2$
        }

define command {
  command_name    check_local_log
  command_line    $USER1$/check_log -F $ARG1$ -O /tmp/nagios.logcheck.processed -q $ARG2$
}

define command{
        command_name    check_dns
        command_line    $USER1$/check_dns -H $ARG1$ -s $HOSTADDRESS$
        }


define command{
        command_name    check_ftp
        command_line    $USER1$/check_ftp -H $HOSTADDRESS$
        }


define command{
        command_name    check_hpjd
        command_line    $USER1$/check_hpjd -H $HOSTADDRESS$ -C public
        }

define command {
        command_name    check_http_content
        command_line    $USER1$/check_http -I $HOSTADDRESS$ -H $ARG1$ -u $ARG2$ -s $ARG3$ -f follow
        }

define command {
        command_name    check_https_content
        command_line    $USER1$/check_http -I $HOSTADDRESS$ -H $ARG1$ -u $ARG2$ -s $ARG3$ -f follow -S
        }

define command {
      command_name    check_unauthorized_https_content
      command_line    $USER1$/check_http -I $HOSTADDRESS$ -H $ARG1$ -u $ARG2$ -s $ARG3$ -f follow -e 401 -S
      }

define command {
      command_name    check-host-alive-by-http
      command_line    $USER1$/check_tcp -H $HOSTADDRESS$ -p 80
}

define command {
      command_name    check-ip-alive-by-http
      command_line    $USER1$/check_tcp -H $ARG1$ -p 80
}

define command {
      command_name    check-host-alive-by-https
      command_line    $USER1$/check_tcp -H $HOSTADDRESS$ -p 443
}

define command {
        command_name    check_https_image_content
        command_line    $USER1$/check_http -I $HOSTADDRESS$ -H $ARG1$ -u $ARG2$ -f follow -S
        }

define command {
        command_name    check_http_image_content_with_port
        command_line    $USER1$/check_http -I $HOSTADDRESS$ -H $ARG1$ -u $ARG2$ -p $ARG3$ -f follow
        }

define command{
        command_name    check_campfire_poller
        command_line    $USER1$/check_http -I $HOSTADDRESS$ -p 2345 -u /stats -w 2 -c 3 -N
	}

define command{
       command_name    check_mongrel_http_content
       command_line    $USER1$/check_http -I $HOSTADDRESS$ -H $ARG1$ -u $ARG2$ -s $ARG3$ -p $ARG4$
       }


define command{
        command_name    check_nntp
        command_line    $USER1$/check_nntp -H $HOSTADDRESS$
        }


define command{
        command_name    check_ping
        command_line    $USER1$/check_ping -H $HOSTADDRESS$ -w $ARG1$ -c $ARG2$ -p 5
        }

define command{
        command_name    check_pop
        command_line    $USER1$/check_pop -H $HOSTADDRESS$
        }

define command{
        command_name    check_smtp
        command_line    $USER1$/check_smtp -H $HOSTADDRESS$
        }

define command{
        command_name    check_smtp_relay
        command_line    $USER1$/check_smtp -H $HOSTADDRESS$ -e ESMTP -C "MAIL FROM: nagios@37signals.com" -R "250" -C "RCPT TO: system@highrisehq.com" -R "250"
        }

define command{
	command_name	check_tcp
	command_line	$USER1$/check_tcp -H $HOSTADDRESS$ -p $ARG1$
	}

define command{
	command_name	check_ssh
	command_line	$USER1$/check_ssh $HOSTADDRESS$
	}

define command{
        command_name    check_telnet
        command_line    $USER1$/check_tcp -H $HOSTADDRESS$ -p 23
}

define command{
	command_name	check_udp
	command_line	$USER1$/check_udp -H $HOSTADDRESS$ -p $ARG1$
}

# 'check_mysql' check mysql connectivity

define command{
	command_name	check_mysql
	command_line	$USER1$/check_mysql -H $ARG1$ -u nagios -p $ARG2$
}


# 'check_mysqlrep' command for mysql replication status
# 

define command { 
	command_name    check_replication
	command_line    $USER1$/check_nrpe -c check_replication -H $HOSTADDRESS$ -t 20
	
}

define command {
	command_name	check_mysqlrep
	command_line	<%= @node[:nagios][:plugins_dir] %>/check-mysql-slave.pl --host $HOSTADDRESS$ --port $ARG1$ --user replcheck --password $ARG2$ --warn $ARG3$ --crit $ARG4$
}

define command {
	command_name	check_blacklist
	command_line	<%= @node[:nagios][:plugins_dir] %>/check_bl_async.pl -H $HOSTADDRESS$ -B $ARG1$ -c $ARG2$
}

# nrpe remote host checks

define command{ 
	command_name    check_nrpe_alive 
	command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -t 20
	} 

define command{ 
	command_name    check_nrpe 
	command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c $ARG1$ -t 20
	} 

define command{ 
	command_name    check_load
	command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_load -t 20
} 

define command{ 
	command_name    check_disk
	command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_$ARG1$ -t 20
} 

define command{ 
	command_name    check_all_disks
	command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_all_disks -t 20
} 

define command{ 
	command_name    check_traffic
	command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c traffic -t 20
}

define command{ 
	command_name    check_mysqlhealth
	command_line    $USER1$/check_mysql_health --hostname $HOSTADDRESS$ --username nagios --password $ARG1$ --port $ARG2$ --mode $ARG3$ --warning $ARG4$ --critical $ARG5$
} 

define command{ 
	command_name    check_iowait_time
	command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_iowait_time -t 20
} 

define command{ 
	command_name    check_tps
	command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_tps -t 20
} 

define command{ 
	command_name    check_swap
	command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_swap -t 20
} 

define command{ 
	command_name    check_solr_index
	command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_$ARG1$_solr_index -t 20
} 

# dummy commands for passive checks

define command{
	command_name	no-disk-checks
	command_line	/usr/local/nagios/libexec/check_dummy 2 "CRITICAL: Results of disk checks not coming in!"
}
	
define command{
	command_name	no-mem-checks
	command_line	/usr/local/nagios/libexec/check_dummy 2 "CRITICAL: Results of memory checks not coming in!"
}
	
# Notification


define command {
  command_name  host-notify-by-email
  command_line  /usr/bin/printf "%b" "$LONGDATETIME$\n\n$HOSTALIAS$ $NOTIFICATIONTYPE$ $HOSTSTATE$\n\n$HOSTOUTPUT$\n\nLogin: ssh://$HOSTNAME$" | /bin/mail -s "[SC-CHI] $NOTIFICATIONTYPE$ - $HOSTALIAS$ $HOSTSTATE$! : $NOTIFICATIONCOMMENT$" $CONTACTEMAIL$
}


define command{
  command_name  host-notify-by-campfire
  command_line  <%= @node[:nagios][:notifiers_dir] %>/campfire -s 37s -r "<%= @node[:monitoring_campfire_room] %>" -S -l <%= @node[:campfire_token] %> -p X -m "[SC-CHI] $HOSTALIAS$ (ssh://$HOSTNAME$) $HOSTSTATE$ $NOTIFICATIONTYPE$ $HOSTSTATE$ $HOSTOUTPUT$ : $NOTIFICATIONCOMMENT$"

}

define command{
  command_name  host-notify-by-jabber
  command_line  <%= @node[:nagios][:notifiers_dir] %>/jabber -j $CONTACTADDRESS1$ -m "[SC-CHI] $HOSTALIAS$ (ssh://$HOSTNAME$) $HOSTSTATE$ $NOTIFICATIONTYPE$ $HOSTSTATE$ $HOSTOUTPUT$ : $NOTIFICATIONCOMMENT$"

}

define command{
  command_name  host-notify-by-sms-gateway
  command_line  <%= @node[:nagios][:notifiers_dir] %>/twilio -n $CONTACTPAGER$ -a <%= @node[:twilio_account_id] %> -t <%= @node[:twilio_token] %> -f <%= @node[:twilio_number] %> -m "[SC-CHI] $HOSTALIAS$ $HOSTSTATE$ $NOTIFICATIONTYPE$ $HOSTOUTPUT$ : $NOTIFICATIONCOMMENT$"
}

define command{
  command_name  host-notify-by-clickatell-sms-gateway
  command_line  <%= @node[:nagios][:notifiers_dir] %>/clickatell -n $CONTACTPAGER$ -u <%= @node[:clickatell_username] %> -p <%= @node[:clickatell_password] %> -a <%= @node[:clickatell_api_id] %> -m "[SC-CHI] $HOSTALIAS$ $HOSTSTATE$ $NOTIFICATIONTYPE$ $HOSTOUTPUT$ : $NOTIFICATIONCOMMENT$"
}

define command{
  command_name  host-notify-by-bulksms-gateway
  command_line  <%= @node[:nagios][:notifiers_dir] %>/bulksms -n $CONTACTPAGER$ -u <%=  @notifiers[:bulksms][:username] %> -p <%=  @notifiers[:bulksms][:password] %> -c <%=  @notifiers[:bulksms][:country] %> -m "[SC-CHI] $HOSTALIAS$ $HOSTSTATE$ $NOTIFICATIONTYPE$ $HOSTOUTPUT$ : $NOTIFICATIONCOMMENT$"
}

define command{
  command_name  host-notify-by-sms-email
  command_line  /usr/bin/printf "%b" "[SC-CHI] $HOSTALIAS$ $NOTIFICATIONTYPE$ $HOSTSTATE$\n\n$HOSTOUTPUT$" | /bin/mail -s "$HOSTALIAS$ $HOSTSTATE$! : $NOTIFICATIONCOMMENT$" $CONTACTPAGER$

}

# 'notify-by-email' command definition
define command{
  command_name  service-notify-by-email
  command_line  /usr/bin/printf "%b" "[SC-CHI] $LONGDATETIME$ - $SERVICEDESC$ $SERVICESTATE$\n\n$HOSTALIAS$  $NOTIFICATIONTYPE$\n\n$SERVICEOUTPUT$\n\nLogin: ssh://$HOSTNAME$ : $NOTIFICATIONCOMMENT$" | /bin/mail -s "** $NOTIFICATIONTYPE$ - $HOSTALIAS$ - $SERVICEDESC$ - $SERVICESTATE$" $CONTACTEMAIL$
}


define command {
  command_name  service-notify-by-campfire
  command_line  <%= @node[:nagios][:notifiers_dir] %>/campfire -s 37s -r "<%= @node[:monitoring_campfire_room] %>" -S -l <%= @node[:campfire_token] %> -p X -m "[SC-CHI] $SERVICEDESC$ $SERVICESTATE$ $HOSTALIAS$ (ssh://$HOSTNAME$) $NOTIFICATIONTYPE$ $SERVICEOUTPUT$ : $NOTIFICATIONCOMMENT$"

}

define command{
  command_name  service-notify-by-sms-email
  command_line  /usr/bin/printf "%b" "[SC-CHI] $SERVICEDESC$ $SERVICESTATE$ $HOSTNAME$ $NOTIFICATIONTYPE$ $SERVICEOUTPUT$ : $NOTIFICATIONCOMMENT$" | /bin/mail -s "" $CONTACTPAGER$
  }

define command {
  command_name  service-notify-by-sms-gateway
  command_line  <%= @node[:nagios][:notifiers_dir] %>/twilio -n $CONTACTPAGER$ -a <%= @node[:twilio_account_id] %> -t <%= @node[:twilio_token] %> -f <%= @node[:twilio_number] %> -m "[SC-CHI] $SERVICEDESC$ $SERVICESTATE$ $HOSTNAME$ $NOTIFICATIONTYPE$ $SERVICEOUTPUT$ : $NOTIFICATIONCOMMENT$"
}

define command {
  command_name  service-notify-by-clickatell-sms-gateway
  command_line  <%= @node[:nagios][:notifiers_dir] %>/clickatell -n $CONTACTPAGER$ -u <%= @node[:clickatell_username] %> -p <%= @node[:clickatell_password] %> -a <%= @node[:clickatell_api_id] %> -m "[SC-CHI] $SERVICEDESC$ $SERVICESTATE$ $HOSTNAME$ $NOTIFICATIONTYPE$ $SERVICEOUTPUT$ : $NOTIFICATIONCOMMENT$"
}

define command {
  command_name  service-notify-by-bulksms-gateway
  command_line  <%= @node[:nagios][:notifiers_dir] %>/bulksms -n $CONTACTPAGER$ -u <%= @notifiers[:bulksms][:username] %> -p <%= @notifiers[:bulksms][:password] %> -c <%= @notifiers[:bulksms][:country] %> -m "[SC-CHI] $SERVICEDESC$ $SERVICESTATE$ $HOSTNAME$ $NOTIFICATIONTYPE$ $SERVICEOUTPUT$ : $NOTIFICATIONCOMMENT$"
}

define command {
  command_name  service-notify-by-jabber
  command_line  <%= @node[:nagios][:notifiers_dir] %>/jabber -j $CONTACTADDRESS1$ -m "[SC-CHI] $SERVICEDESC$ $SERVICESTATE$ $HOSTALIAS$ (ssh://$HOSTNAME$) $NOTIFICATIONTYPE$ $SERVICEOUTPUT$ : $NOTIFICATIONCOMMENT$"

}